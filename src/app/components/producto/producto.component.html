<!--MODAL EDITAR -->
<div class="modal fade" id="ModalAgregar" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title" id="exampleModalScrollableTitle">Agregar Producto</h6>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="form mr-lg-auto" #postEditForm="ngForm">
          <input name="codigoProducto" hidden="" type="text" class="form-control" [(ngModel)]="tempProduct.id">
          <div class="form-row">
            <div class="form-group col-md-6">
              <label>Nombre</label>
              <input type="text" name="name" class="form-control" #name="ngModel" [(ngModel)]="tempProduct.name"
                required pattern="[a-zA-Z ]+">
              <small *ngIf="!name.valid && name.touched" class="invalid-feedback d-block">El nombre no es valido</small>
            </div>
            <div class="form-group col-md-6">
              <label>Descripción</label>
              <input type="text" name="description" class="form-control" [(ngModel)]="tempProduct.description">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-6">
              <label>Categoria</label>
              <select name="category_id" [(ngModel)]="tempProduct.idCategory" class="form-control">
                <option *ngFor="let cat of categories" value="{{cat.id}}">
                  {{cat.name}}
                </option>
              </select>
            </div>
            <div class="form-group col-md-6">
              <label>Proveedor</label>
              <select name="supplier_id" [(ngModel)]="tempProduct.idSupplier" class="form-control">
                <option *ngFor="let sup of suppliers" value="{{sup.id}}">
                  {{sup.name}}
                </option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-4">
              <label>Existencia Actual</label>
              <input type="number" name="actual" class="form-control" [(ngModel)]="tempProduct.currentExist">
            </div>
            <div class="form-group col-md-4">
              <label>Existencia Mínima</label>
              <input type="number" name="minima" class="form-control" [(ngModel)]="tempProduct.minExist">
            </div>
            <div class="form-group col-md-4">
              <label>Precio</label>
              <input type="number" name="price" class="form-control" [(ngModel)]="tempProduct.price">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Imagen</label>
              <angular-file-uploader [config]="afuConfig" [resetUpload]=resetVar (ApiResponse)="imageUpload($event)">
              </angular-file-uploader>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        <input type="submit" class="btn btn-light" value="Agregar" data-dismiss="modal" (click)="create()">
      </div>
    </div>
  </div>
</div>
<!--MODAL Agregar -->
<!--MODAL EDITAR -->
<div class="modal fade" id="ModalEditar" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title" id="exampleModalScrollableTitle">Editar Producto</h6>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="form mr-lg-auto" #postEditForm="ngForm">
          <input name="codigoProducto" hidden="" type="text" class="form-control" [(ngModel)]="tempProduct.id">
          <div class="form-row">
            <div class="form-group col-md-6">
              <label>Nombre</label>
              <input type="text" name="name" class="form-control" #name="ngModel" [(ngModel)]="tempProduct.name"
                required pattern="[a-zA-Z ]+">
              <small *ngIf="!name.valid && name.touched" class="invalid-feedback d-block">El nombre no es valido</small>
            </div>
            <div class="form-group col-md-6">
              <label>Descripción</label>
              <input type="text" name="description" class="form-control" [(ngModel)]="tempProduct.description">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-6">
              <label>Categoria</label>
              <select name="category_id" [(ngModel)]="tempProduct.idCategory" class="form-control">
                <option *ngFor="let cat of categories" value="{{cat.id}}">
                  {{cat.name}}
                </option>
              </select>
            </div>
            <div class="form-group col-md-6">
              <label>Proveedor</label>
              <select name="supplier_id" [(ngModel)]="tempProduct.idSupplier" class="form-control">
                <option *ngFor="let sup of suppliers" value="{{sup.id}}">
                  {{sup.name}}
                </option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-4">
              <label>Existencia Actual</label>
              <input type="number" name="actual" class="form-control" [(ngModel)]="tempProduct.currentExist">
            </div>
            <div class="form-group col-md-4">
              <label>Existencia Mínima</label>
              <input type="number" name="minima" class="form-control" [(ngModel)]="tempProduct.minExist">
            </div>
            <div class="form-group col-md-4">
              <label>Precio</label>
              <input type="number" name="price" class="form-control" [(ngModel)]="tempProduct.price">
            </div>
          </div>
          <div class="form-group col-md-4">
            <label>Imagen</label>
            <img src="{{url+'product/getImage/'+tempProduct.image}}" class="w-100">
          </div>
          <div class="form-row">
            <div class="form-group">
              <angular-file-uploader [config]="afuConfig" [resetUpload]=resetVar (ApiResponse)="imageUpload($event)">
              </angular-file-uploader>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        <input type="submit" class="btn btn-light" value="Actualizar" data-dismiss="modal" (click)="update()">
      </div>
    </div>
  </div>
</div>
<!--MODAL EDITAR -->
<!--MODAL ELIMINAR -->
<div class="modal fade" id="borrarModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">

  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Confirmar borrado?</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Esta seguro que desea borrar Su usuario?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-danger mr-2" (click)="delete()" data-dismiss="modal">Confirmar
          borrado</button>
      </div>
    </div>
  </div>
</div>
<!--MODAL ELIMINAR -->
<div class="add">
  <br>
  <button id="boton" (click)="resetTempProduct()" data-toggle="modal" data-target="#ModalAgregar" class="btn btn-warning">Agregar</button>
  <br>
</div>
<div class="table-responsive-sm">
  <table class="table">
    <thead class="thead-dark">
      <tr>
        <th scope="col">#</th>
        <th scope="col">ID</th>
        <th scope="col">Nombre</th>
        <th scope="col">Descripción</th>
        <th scope="col">Stock</th>
        <th scope="col">Precio</th>
        <th scope="col">Categoría</th>
        <th scope="col">Proveedor</th>
        <th scope="col">Imagen</th>
        <th *ngIf="token" scope="col">Acción</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of products; index as i">
        <th scope="row">{{ i + 1 }}</th>
        <td>{{ product.id}}</td>
        <td>{{ product.name}}</td>
        <td>{{ product.description}}</td>
        <td *ngIf="product.currentExist <= product.minExist" [ngStyle]="{'background-color':'#FDFD96'}">{{ product.currentExist}}</td>
        <td *ngIf="product.currentExist > product.minExist">{{ product.currentExist}}</td>
        <td>{{ product.price}}</td>
        <td>
          <span *ngFor="let cat of categories; index as x">
            <p *ngIf="product.idCategory==cat.id">{{ cat.name}}</p>
          </span>
        </td>
        <td>
          <span *ngFor="let sup of suppliers; index as y">
            <p *ngIf="product.idSupplier==sup.id">{{ sup.name}}</p>
          </span>
        </td>
        <td><img src="{{url+'product/getImage/'+product.image}}" class="w-100"></td>
        <td *ngIf="token" ><button (click)="getProduct(product.id)" data-toggle="modal" data-target="#ModalEditar"
            class="btn btn-info">Editar</button>
            <br>
            <br>
          <button (click)="getProduct(product.id)" type="button" class="btn btn-danger mr-2" data-toggle="modal"
            data-target="#borrarModal">
            Borrar
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
